<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminpage">
	<resultMap id="MemberMap" type="MemberVO">
	        <result column="id"            property="id"   />
	        <result column="password"      property="password"  />
	        <result column="email"         property="email"/>
	        <result column="grade"         property="grade"/>  
	        <result column="reg_date"          property="regdate"/> 
	        <result column="no"        property="no"/>   
	</resultMap>    
      
    <!-- 페이징 + 검색 -->
     <select id="listPageSearchBox" parameterType="hashMap" resultMap="MemberMap">
        SELECT roadnum,road2.*
	    FROM(
          SELECT row_number() OVER(ORDER BY road.no) AS roadnum, road.*
           FROM member road
           WHERE grade = 1
           <if test="keyword !=null and keyword !=''">
                         AND id LIKE '%'||#{keyword}||'%' 
           </if> 
          ORDER BY road.no
          ) road2
	    WHERE roadnum BETWEEN #{displayPost} AND #{postNum}+ #{displayPost}-1         
	    ORDER BY road2.no
     </select>

     <!-- 검색  카운팅 -->
      <select id="searchCountBox" parameterType="hashMap" resultType="int">
	      SELECT COUNT(id) cnt
	      FROM member
	      WHERE 1=1 
	      AND grade = 1
           <if test="keyword !=null and keyword !=''">
                         AND id LIKE '%'||#{keyword}||'%' 
           </if> 
     </select>
     
     <!-- 페이징 + 검색 -->
     <select id="listPageSearchBox2" parameterType="hashMap" resultMap="MemberMap">
        SELECT roadnum,road2.*
        FROM(
          SELECT row_number() OVER(ORDER BY road.no) AS roadnum, road.*
           FROM member road
           WHERE grade = 2
           AND  id NOT in  #{nekeyword}
           
           <if test="nekeyword !=null and nekeyword !=''">
                         AND id LIKE '%'||#{keyword2}||'%' 
           </if> 
          ORDER BY road.no
          ) road2
        WHERE roadnum BETWEEN #{displayPost2} AND #{postNum2}+ #{displayPost2}-1         
        ORDER BY road2.no
     </select>

     <!-- 검색  카운팅 -->
      <select id="searchCountBox2" parameterType="hashMap" resultType="int">
          SELECT COUNT(id) cnt
          FROM member
          WHERE 1=1 
          AND grade = 2
          AND  id NOT in  #{nekeyword}

          
           <if test="keyword2 !=null and keyword2 !=''">
                         AND id LIKE '%'||#{keyword2}||'%' 
           </if> 
     </select>
     
     <!-- 페이징 + 검색 -->
     <select id="listPageSearchBox3" parameterType="hashMap" resultMap="MemberMap">
        SELECT roadnum,road3.*
        FROM(
          SELECT row_number() OVER(ORDER BY road.no) AS roadnum, road.*
           FROM member road
           WHERE grade = 3
           <if test="keyword3 !=null and keyword3 !=''">
                         AND id LIKE '%'||#{keyword3}||'%' 
           </if> 
          ORDER BY road.no
          ) road3
        WHERE roadnum BETWEEN #{displayPost3} AND #{postNum3}+ #{displayPost3}-1         
        ORDER BY road3.no
     </select>

     <!-- 검색  카운팅 -->
      <select id="searchCountBox3" parameterType="hashMap" resultType="int">
          SELECT COUNT(id) cnt
          FROM member
          WHERE 1=1 
          AND grade = 3
           <if test="keyword3 !=null and keyword3 !=''">
                         AND id LIKE '%'||#{keyword3}||'%' 
           </if> 
     </select>
     

</mapper>